<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Gordijnen zonder flikker</title>
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<style>
  *{ box-sizing:border-box; }

  body{
    margin:0;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#f4f1ff;
    font-family:system-ui, sans-serif;
  }

  .stage{
    width:360px;
    aspect-ratio:498 / 286;      /* originele gordijnverhouding */
    position:relative;
    border-radius:24px;
    overflow:hidden;
    background:#fff;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
  }

  /* Cijfer (achter alles) */
  .digit{
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:140px;
    font-weight:800;
    color:#333;
    z-index:1;
  }

  /* Gordijn-lagen */
  .curtain-layer{
    position:absolute;
    inset:0;
    pointer-events:none;
  }

  /* Still blijft ALTIJD zichtbaar */
  .curtain-still{
    z-index:5;
  }

  /* Animatie ligt erboven en fade-in */
  .curtain-anim{
    z-index:6;
    opacity:0;
    transition:opacity .08s linear;
    will-change:opacity;
  }

  .curtain-anim.on{
    opacity:1;
  }

  .curtain-layer img{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
  }

  button{
    margin-top:16px;
    padding:12px 18px;
    font-size:16px;
    border-radius:12px;
    border:none;
    background:#ff8a65;
    color:#fff;
    cursor:pointer;
  }
</style>
</head>

<body>

<div>
  <div class="stage">
    <!-- cijfer -->
    <div class="digit">5</div>

    <!-- STILL: altijd zichtbaar -->
    <div class="curtain-layer curtain-still">
      <img src="gordijnen_still.png" alt="">
    </div>

    <!-- ANIMATIE: fade-in boven still -->
    <div class="curtain-layer curtain-anim" id="curtain-anim">
      <img id="curtain-gif" src="gordijnen_openen.gif" alt="">
    </div>
  </div>

  <div style="text-align:center">
    <button id="play">Speel animatie</button>
  </div>
</div>

<script>
  const animLayer = document.getElementById("curtain-anim");
  const gifEl     = document.getElementById("curtain-gif");
  const playBtn   = document.getElementById("play");

  // ðŸ‘‰ stel dit in op de echte lengte van jouw GIF
  const GIF_DURATION_MS = 1400;

  // Preload om witte flits te voorkomen
  function preloadGif(){
    return new Promise(resolve=>{
      const img = new Image();
      img.onload = ()=>resolve();
      img.onerror = ()=>resolve();
      img.src = "gordijnen_openen.gif";
    });
  }

  async function playCurtain(){
    // 1. zorg dat GIF al in cache zit
    await preloadGif();

    // 2. forceer herstart van GIF
    gifEl.src = "gordijnen_openen.gif?t=" + Date.now();

    // 3. pas zichtbaar maken als browser kan tekenen
    gifEl.onload = ()=>{
      animLayer.classList.add("on");

      // 4. na volledige animatie weer weg
      setTimeout(()=>{
        animLayer.classList.remove("on");
      }, GIF_DURATION_MS);
    };
  }

  playBtn.addEventListener("click", playCurtain);
</script>

</body>
</html>
