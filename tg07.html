<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Beloning: goed2 + cijfer + magic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <style>
    :root{
      --bg-top:#f4f1ff;
      --bg-bottom:#fef6e9;
      --card-shadow:0 10px 25px rgba(0,0,0,0.08);
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    html,body{ margin:0; padding:0; height:100%; }

    body{
      font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
      background:linear-gradient(to bottom,var(--bg-top),var(--bg-bottom));
      display:flex;
      justify-content:center;
      align-items:stretch;
      overflow:hidden;
    }

    .wrap{
      width:100%;
      max-width:900px;
      min-height:100vh;
      padding:clamp(12px,3vh,24px);
      padding-top:calc(clamp(12px,3vh,24px) + env(safe-area-inset-top));
      padding-bottom:calc(clamp(12px,3vh,24px) + env(safe-area-inset-bottom));
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    /* ✅ zelfde “gordijnhoogte-gevoel” als je vorige versie */
    .reward-bar{
      width:min(86vw, 520px);
      height:min(12vh, 110px);           /* <- hoogte zoals gordijnen */
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .reward-left{
      height:100%;
      aspect-ratio: 1.6 / 1;             /* een beetje “breed” zoals een gifje */
      border-radius:18px;
      overflow:hidden;
      box-shadow:var(--card-shadow);
      background:rgba(255,255,255,0.6);
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .reward-left img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .reward-right{
      height:100%;
      aspect-ratio: 1 / 1;
      border-radius:18px;
      overflow:hidden;
      box-shadow:var(--card-shadow);
      background:#fff;
      position:relative;
      flex:0 0 auto;
    }

    /* cijfer (achter) */
    .digit{
      position:absolute;
      inset:0;
      background-repeat:no-repeat;
      background-position:center;
      background-size:contain;
    }

    /* magic overlay (speelt 1x af) */
    .magic{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0;
      transition:opacity .06s linear;
    }
    .magic.on{ opacity:1; }

    .magic img{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
    }

    /* demo-scanvlak eronder zodat je ziet hoe het in TG07 past */
    .scan-area{
      flex:1 1 auto;
      min-height:62vh;
      border-radius:28px;
      border:4px dashed rgba(255,255,255,0.8);
      background:rgba(255,255,255,0.12);
      box-shadow:0 10px 22px rgba(0,0,0,0.12);
      display:flex;
      align-items:center;
      justify-content:center;
      color:rgba(0,0,0,0.55);
      font-weight:700;
    }

    .btnrow{
      display:flex;
      gap:10px;
      justify-content:center;
    }
    button{
      padding:12px 16px;
      border-radius:14px;
      border:none;
      background:#ff8a65;
      color:#fff;
      font-weight:800;
      cursor:pointer;
    }
    button:active{ transform:scale(0.99); }

    @media (max-width:600px){
      .reward-bar{
        width:min(92vw, 520px);
        height:min(12vh, 100px);
        gap:10px;
      }
      .reward-left, .reward-right{ border-radius:16px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <!-- ✅ Beloningsstrook (jouw wens) -->
    <div class="reward-bar" aria-label="Beloning">
      <div class="reward-left" aria-label="Goed animatie">
        <img id="goodGif" src="goed2.gif" alt="">
      </div>

      <div class="reward-right" aria-label="Cijfer met magie">
        <div class="digit" id="digit"></div>

        <div class="magic" id="magicLayer" aria-hidden="true">
          <img id="magicGif" src="magic.gif" alt="">
        </div>
      </div>
    </div>

    <!-- demo knoppen -->
    <div class="btnrow">
      <button id="demo5">Laat 5 zien + magie</button>
      <button id="demo9">Laat 9 zien + magie</button>
    </div>

    <!-- placeholder voor je echte scanvlak -->
    <div class="scan-area">
      (Hier komt je grote scanvak zoals in TG07/TG08)
    </div>
  </div>

  <script>
    const digitEl = document.getElementById("digit");
    const magicLayer = document.getElementById("magicLayer");
    const magicGif = document.getElementById("magicGif");

    // ⏱ Zet dit op de echte lengte van magic.gif (ms)
    const MAGIC_DURATION_MS = 900;

    let busy = false;

    function setDigit(d){
      digitEl.style.backgroundImage = "url('marbotic" + d + ".png')";
    }

    // ✅ Speel magic.gif precies 1x af over het cijfer
    function playMagicOnce(){
      if (busy) return;
      busy = true;

      // herstart gif (belangrijk op iPad/Safari)
      magicGif.onload = () => {
        magicLayer.classList.add("on");
        setTimeout(() => {
          magicLayer.classList.remove("on");
          busy = false;
        }, MAGIC_DURATION_MS);
      };

      magicGif.src = "magic.gif?t=" + Date.now();
    }

    // ✅ 1 functie voor jouw spel: laat goed2 zien + cijfer rechts + magic 1x
    function showReward(digit){
      setDigit(digit);
      playMagicOnce();
    }

    // demo
    document.getElementById("demo5").addEventListener("click", () => showReward(5));
    document.getElementById("demo9").addEventListener("click", () => showReward(9));

    // start met een cijfer (zodat je meteen ziet hoe het eruit ziet)
    setDigit(3);
  </script>
</body>
</html>
